<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SchoolTools - Study with Quizlet</title>
        <link rel="stylesheet" href="/static/style/global.css" />
        <script type="module" src="/static/js/global.js"></script>
    </head>
    <body>
        <header></header>
        <main>
            <form id="hide-this">
                <h2>Study Quizlet set</h2>
                <p>
                    Copy a link to your Quizlet set's main page, and paste it into the text box below.
                    After submitting the link, you can play a game to test your vocabulary knowledge.
                </p>
                <input type="url" name="link" placeholder="Quizlet Set" />
                <input type="submit" value="Load Set" />
                <p>
                    <i>
                        You can also copy Quizlet sets to SchoolTools. Quizlet might try preventing
                        this page from working in the future, so it's recommended to make an account
                        and try copying your set to it before that happens.
                    </i>
                </p>
                <details>
                    <summary>Help: How to copy a Quizlet set to your SchoolTools account</summary>
                    <ol>
                        <li><a href="/vocabsets/create/">Create a new vocabulary set</a></li>
                        <li>At the top, click the button to import your set from Quizlet</li>
                        <li>Fix or remove any missing entries, and save your set</li>
                    </ol>
                </details>
            </form>
            <div id="study-game">
            </div>
        </main>
        <footer></footer>
        <script type="module">
            import api from "/static/js/api.js";
            import ready from "/static/js/common/ready.js";
            import handleForm from "/static/js/common/form.js";
            import {getSet, openVocabPage} from "/static/js/pages/vocabsets.js";
            import StudyVocabGame from "/static/js/pages/studyvocab.js";
            import {randArr, randInt} from "/static/js/common/random.js";
            
            window.openVocabPage = openVocabPage; // javascript: urls
            
            ready.then(async () => {
                handleForm(async result => {
                    const link = result.get("link");
                    
                    const res = await api("other/quizlet-get", {
                        path: link
                    });
                    
                    if(res.type !== "success") return res;
                    
                    res.terms = res.terms.filter(term => term.hint !== "" && term.definition !== "");
                    
                    doc.el("#hide-this").style.display = "none";
                    new StudyVocabGame(doc.el("#study-game"), res.formatted);
                })
            });
            
        </script>
    </body>
</html>